<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì˜¤ëŠ˜ ë­ ë¨¹ì§€?</title>
    <style>
        :root { --primary: #FF5722; --lunch: #FFC107; --dinner: #3F51B5; --bg: #F8F9FA; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: sans-serif; margin: 0; background: var(--bg); display: flex; justify-content: center; height: 100vh; overflow: hidden; }
        .container { width: 100%; max-width: 450px; height: 100%; background: white; position: relative; }
        
        /* âœ… í´ë¦­ ë¬´ì‹œ ì˜µì…˜(pointer-events) ì‚­ì œ ì™„ë£Œ */
        .page { position: absolute; top: 0; left: 0; width: 100%; height: 100%; padding: 20px; display: none; flex-direction: column; background: white; }
        .visible { display: flex !important; }
        
        #home { justify-content: center; align-items: center; text-align: center; }
        .mode-btn { width: 90%; padding: 30px 20px; margin: 15px 0; border: none; border-radius: 25px; color: white; font-size: 1.6rem; font-weight: bold; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        #slot-machine { height: 100px; font-size: 2rem; font-weight: bold; color: var(--primary); display: flex; justify-content: center; align-items: center; border: 4px solid #f0f0f0; border-radius: 20px; margin-bottom: 20px; background: #fff; }
        .btn-pick { width: 100%; padding: 25px; border-radius: 20px; border: none; color: white; font-size: 1.6rem; font-weight: bold; cursor: pointer; }
        .admin-section { flex: 1; display: flex; flex-direction: column; overflow: hidden; border-top: 1px solid #eee; padding-top: 15px; margin-top: 10px; }
        .list-box { flex: 1; border: 1px solid #f9f9f9; overflow-y: auto; background: #fdfdfd; border-radius: 15px; padding: 10px; }
        .menu-item { display: flex; justify-content: space-between; align-items: center; padding: 12px; border-bottom: 1px solid #f0f0f0; margin-bottom: 6px; }
        #modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 9999; justify-content: center; align-items: center; }
        .modal-inner { background: white; width: 88%; padding: 30px; border-radius: 30px; text-align: center; }
    </style>
</head>
<body>

<div class="container">
    <div id="home" class="page visible">
        <h1 style="margin-bottom: 40px; font-size: 2.2rem;">ğŸ± ì˜¤ëŠ˜ ë­ ë¨¹ì§€?</h1>
        <button type="button" class="mode-btn" style="background:var(--lunch);" onclick="goApp('lunch')">â˜€ï¸ ì ì‹¬ ì¶”ì²œ</button>
        <button type="button" class="mode-btn" style="background:var(--dinner);" onclick="goApp('dinner')">ğŸŒ™ ì €ë… ì¶”ì²œ</button>
    </div>

    <div id="app" class="page">
        <div class="header">
            <button onclick="location.reload()" style="padding:10px 15px; border-radius:12px; border:1px solid #ddd; background:#fff; font-weight:bold;">â—€ í™ˆ</button>
            <h2 id="title" style="margin:0; font-size: 1.3rem;">ë©”ë‰´ ì¶”ì²œ</h2>
            <div style="width:50px;"></div>
        </div>
        <div id="slot-machine">ì¤€ë¹„ ì™„ë£Œ!</div>
        <button id="pickBtn" class="btn-pick" onclick="startRolling()">ğŸ² ë©”ë‰´ ë½‘ê¸°!</button>
        <div class="admin-section">
            <p style="font-weight:bold; margin:0 0 10px 5px; color:#444;">ğŸ“‹ ë‚´ ë©”ë‰´ ë¦¬ìŠ¤íŠ¸ (<span id="menuCount">0</span>)</p>
            <div style="display:flex; gap:8px; margin-bottom:15px;">
                <input type="text" id="menuInput" style="flex:1; padding:12px; border:2px solid #eee; border-radius:12px; font-size:16px;" placeholder="ë©”ë‰´ ì¶”ê°€">
                <button onclick="addMenu()" style="padding:0 20px; background:#4CAF50; color:white; border:none; border-radius:12px; font-weight:bold;">ì¶”ê°€</button>
            </div>
            <div id="menuListView" class="list-box"></div>
        </div>
    </div>

    <div id="modal">
        <div class="modal-inner">
            <p style="color:#FF5722; font-weight:bold; margin-bottom:5px;">[ ì˜¤ëŠ˜ì˜ ì¶”ì²œ ]</p>
            <h2 id="resultName" style="font-size:2.6rem; color:#222; margin:10px 0 20px 0;">ìŒì‹ëª…</h2>
            <div style="display:flex; gap:12px; margin-bottom:20px;">
                <button onclick="openMap('naver')" style="flex:1; padding:18px; background:#03C75A; color:white; border:none; border-radius:15px; font-weight:bold; font-size:1.1rem;">ë„¤ì´ë²„</button>
                <button onclick="openMap('kakao')" style="flex:1; padding:18px; background:#FEE500; border:none; border-radius:15px; font-weight:bold; color:#3c1e1e; font-size:1.1rem;">ì¹´ì¹´ì˜¤</button>
            </div>
            <button onclick="closeModal()" style="width:100%; padding:15px; border:none; background:#f0f0f0; border-radius:15px; font-weight:bold; color:#666;">ë‹¤ì‹œ ë½‘ê¸°</button>
        </div>
    </div>
</div>

<script>
    var currentMode = '';
    var menus = [];
    var isRolling = false;

    var defaultData = {
        lunch: ["ê¹€ì¹˜ì°Œê°œ", "ë¶€ëŒ€ì°Œê°œ", "ëˆê¹ŒìŠ¤", "ì œìœ¡ë®ë°¥", "ì§œì¥ë©´", "ì§¬ë½•", "í–„ë²„ê±°", "ìƒŒë“œìœ„ì¹˜", "ìˆœëŒ€êµ­", "ì¹¼êµ­ìˆ˜"],
        dinner: ["ì‚¼ê²¹ì‚´", "ì¹˜í‚¨", "í”¼ì", "ì¡±ë°œ", "ë³´ìŒˆ", "íšŒ", "ê³±ì°½", "ì•„êµ¬ì°œ", "ë‹­ë°œ", "ìŠ¤í…Œì´í¬"]
    };

    function callAdmob() {
        if (window.Android && window.Android.onMenuClick) {
            window.Android.onMenuClick(); 
        }
    }

    function goApp(m) {
        currentMode = m;
        document.getElementById('home').classList.remove('visible');
        document.getElementById('app').classList.add('visible');
        document.getElementById('title').innerText = (m === 'lunch' ? "â˜€ï¸ ì ì‹¬ ì¶”ì²œ" : "ğŸŒ™ ì €ë… ì¶”ì²œ");
        document.getElementById('pickBtn').style.background = (m === 'lunch' ? 'var(--lunch)' : 'var(--dinner)');
        var saved = localStorage.getItem('food_v1_' + m);
        menus = saved ? JSON.parse(saved) : [...defaultData[m]];
        render();
    }

    function render() {
        var html = '';
        for(var i=0; i<menus.length; i++) {
            html += '<div class="menu-item"><span>'+menus[i]+'</span><span style="color:#ff4d4d; font-weight:bold; cursor:pointer;" onclick="delMenu('+i+')">âœ•</span></div>';
        }
        document.getElementById('menuListView').innerHTML = html;
        document.getElementById('menuCount').innerText = menus.length;
        localStorage.setItem('food_v1_' + currentMode, JSON.stringify(menus));
    }

    function startRolling() {
        if (isRolling || menus.length === 0) return;
        isRolling = true;
        var slot = document.getElementById('slot-machine');
        var start = Date.now();
        var timer = setInterval(function() {
            slot.innerText = menus[Math.floor(Math.random() * menus.length)];
            if (Date.now() - start > 1500) {
                clearInterval(timer);
                isRolling = false;
                showResult(slot.innerText);
                callAdmob(); // ê´‘ê³  ì¹´ìš´íŠ¸
            }
        }, 80);
    }

    function showResult(menu) {
        document.getElementById('resultName').innerText = menu;
        document.getElementById('modal').style.display = 'flex';
    }

    function addMenu() {
        var val = document.getElementById('menuInput').value.trim();
        if(val) { menus.unshift(val); document.getElementById('menuInput').value = ''; render(); }
    }

    function delMenu(i) { menus.splice(i, 1); render(); }
    function closeModal() { document.getElementById('modal').style.display = 'none'; }

    function openMap(type) {
        var name = document.getElementById('resultName').innerText;
        var q = encodeURIComponent(name + " ë§›ì§‘");
        if (type === 'naver') {
            window.location.href = 'nmap://search?query=' + q + '&appname=com.myname.randommenu';
        } else {
            window.location.href = 'kakaomap://search?q=' + q;
        }
    }
</script>
</body>
</html>

